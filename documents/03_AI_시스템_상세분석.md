# 03. Sensor Game Hub - AI ì‹œìŠ¤í…œ ìƒì„¸ ë¶„ì„

> **ì‘ì„±ì¼**: 2025-01-10
> **ë²„ì „**: v6.1.0
> **ëª©ì **: AI ê²Œì„ ìƒì„± ì‹œìŠ¤í…œ ì™„ì „ ë¶„ì„

---

## ğŸ“‹ ëª©ì°¨

1. [AI ì‹œìŠ¤í…œ ê°œìš”](#1-ai-ì‹œìŠ¤í…œ-ê°œìš”)
2. [InteractiveGameGenerator ì™„ì „ ë¶„ì„](#2-interactivegamegenerator-ì™„ì „-ë¶„ì„)
3. [RAG ì‹œìŠ¤í…œ êµ¬í˜„](#3-rag-ì‹œìŠ¤í…œ-êµ¬í˜„)
4. [í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§](#4-í”„ë¡¬í”„íŠ¸-ì—”ì§€ë‹ˆì–´ë§)
5. [GameMaintenanceManager](#5-gamemaintenancemanager)
6. [Claude Sonnet 4.5 í™œìš©ë²•](#6-claude-sonnet-45-í™œìš©ë²•)
7. [í’ˆì§ˆ ë³´ì¦ ì‹œìŠ¤í…œ](#7-í’ˆì§ˆ-ë³´ì¦-ì‹œìŠ¤í…œ)

---

## 1. AI ì‹œìŠ¤í…œ ê°œìš”

### 1.1 AI ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI ì‹œìŠ¤í…œ ë ˆì´ì–´                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì…ë ¥ ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ ìì—°ì–´ ì…ë ¥                             â”‚
â”‚   - ê²Œì„ ì•„ì´ë””ì–´                         â”‚
â”‚   - ë²„ê·¸ ë¦¬í¬íŠ¸                           â”‚
â”‚   - ê¸°ëŠ¥ ì¶”ê°€ ìš”ì²­                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
ë¶„ì„ ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ GameGenreClassifier                   â”‚
â”‚   - ì¥ë¥´ ë¶„ë¥˜ (8ì¢…)                       â”‚
â”‚   - ê²Œì„ íƒ€ì… ì¶”ë¡  (solo/dual/multi)      â”‚
â”‚   - ì‹ ë¢°ë„ ê³„ì‚°                          â”‚
â”‚                                         â”‚
â”‚ â€¢ RequirementCollector                  â”‚
â”‚   - ìš”êµ¬ì‚¬í•­ ìˆ˜ì§‘                         â”‚
â”‚   - ëŒ€í™”í˜• ìƒí˜¸ì‘ìš©                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
RAG ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ DocumentEmbedder                      â”‚
â”‚   - 400ê°œ ë¬¸ì„œ ì„ë² ë”©                     â”‚
â”‚   - OpenAI text-embedding-3-small       â”‚
â”‚   - 1536 ì°¨ì› ë²¡í„°                       â”‚
â”‚                                         â”‚
â”‚ â€¢ SupabaseVectorStore                   â”‚
â”‚   - pgvector ê²€ìƒ‰                        â”‚
â”‚   - ì½”ì‚¬ì¸ ìœ ì‚¬ë„                         â”‚
â”‚   - Top-K ê²€ìƒ‰ (K=5)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
ìƒì„± ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ InteractiveGameGenerator              â”‚
â”‚   - Claude Sonnet 4.5                   â”‚
â”‚   - 64K í† í° ì¶œë ¥                         â”‚
â”‚   - Temperature: 0.3                    â”‚
â”‚   - 5ë‹¨ê³„ ìƒì„± í”„ë¡œì„¸ìŠ¤                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
ê²€ì¦ ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ GameValidator                         â”‚
â”‚   - HTML êµ¬ì¡° ê²€ì¦                        â”‚
â”‚   - SessionSDK í†µí•© ê²€ì¦                  â”‚
â”‚   - ì„¼ì„œ ì²˜ë¦¬ ê²€ì¦                        â”‚
â”‚   - ê²Œì„ ë¡œì§ ê²€ì¦                        â”‚
â”‚   - UI/UX ê²€ì¦                          â”‚
â”‚   - ìµœì†Œ 95ì  ë³´ì¥                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
ìœ ì§€ë³´ìˆ˜ ë ˆì´ì–´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ GameMaintenanceManager                â”‚
â”‚   - ë²„ê·¸ ìë™ ìˆ˜ì •                        â”‚
â”‚   - ê¸°ëŠ¥ ì¦ë¶„ ì¶”ê°€                        â”‚
â”‚   - ë²„ì „ ê´€ë¦¬                            â”‚
â”‚   - ìë™ ë°±ì—…                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 AI ëª¨ë¸ ì‚¬ìš© ì „ëµ

| ëª¨ë¸ | ìš©ë„ | í† í° | Temperature | Top-P |
|------|------|------|-------------|-------|
| **Claude Sonnet 4.5** | ê²Œì„ ìƒì„± | 64K | 0.3 | 0.9 |
| **Claude Opus 4** | ë³µì¡í•œ ê²Œì„ | 32K | 0.2 | 0.9 |
| **Claude Haiku 3** | ì¥ë¥´ ë¶„ë¥˜ | 4K | 0.7 | 0.95 |
| **GPT-4o** | í´ë°± (ë°±ì—…) | 16K | 0.3 | 0.9 |
| **text-embedding-3-small** | RAG ì„ë² ë”© | - | - | - |

### 1.3 ì„±ëŠ¥ ì§€í‘œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI ì‹œìŠ¤í…œ ì„±ëŠ¥ (100íšŒ í…ŒìŠ¤íŠ¸)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìƒì„± ì„±ê³µë¥ : 98% (98/100)                         â”‚
â”‚ í‰ê·  í’ˆì§ˆ ì ìˆ˜: 97ì  (ëª©í‘œ: 95ì  ì´ìƒ)              â”‚
â”‚ í‰ê·  ìƒì„± ì‹œê°„: 45ì´ˆ                              â”‚
â”‚ â”œâ”€ RAG ê²€ìƒ‰: 2ì´ˆ                                 â”‚
â”‚ â”œâ”€ Claude ìƒì„±: 35ì´ˆ                             â”‚
â”‚ â”œâ”€ ê²€ì¦: 6ì´ˆ                                     â”‚
â”‚ â””â”€ ì €ì¥: 2ì´ˆ                                     â”‚
â”‚                                                  â”‚
â”‚ RAG íš¨ê³¼:                                        â”‚
â”‚ â”œâ”€ RAG ì—†ìŒ: 85% ì„±ê³µë¥ , í‰ê·  88ì                 â”‚
â”‚ â””â”€ RAG ìˆìŒ: 98% ì„±ê³µë¥ , í‰ê·  97ì  (+13%p)        â”‚
â”‚                                                  â”‚
â”‚ ë¹„ìš© (1íšŒ ìƒì„±):                                  â”‚
â”‚ â”œâ”€ Claude API: $0.15 (í‰ê· )                      â”‚
â”‚ â”œâ”€ OpenAI Embedding: $0.001                     â”‚
â”‚ â””â”€ ì´ ë¹„ìš©: $0.151                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. InteractiveGameGenerator ì™„ì „ ë¶„ì„

### 2.1 í´ë˜ìŠ¤ êµ¬ì¡°

```javascript
// server/InteractiveGameGenerator.js (3,880ì¤„)
class InteractiveGameGenerator {
    constructor() {
        // AI ëª¨ë¸ ì´ˆê¸°í™”
        this.anthropicClient = new Anthropic({
            apiKey: process.env.CLAUDE_API_KEY
        });

        // RAG ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        this.embeddings = new OpenAIEmbeddings({
            modelName: 'text-embedding-3-small',
            apiKey: process.env.OPENAI_API_KEY
        });

        this.vectorStore = new SupabaseVectorStore(this.embeddings, {
            client: supabaseClient,
            tableName: 'game_knowledge',
            queryName: 'match_documents'
        });

        // ë³´ì¡° ëª¨ë“ˆ
        this.genreClassifier = new GameGenreClassifier();
        this.requirementCollector = new RequirementCollector();
        this.gameValidator = new GameValidator();
        this.gameScanner = new GameScanner();
        this.gameMaintenanceManager = null;  // ë‚˜ì¤‘ì— ì£¼ì…

        // ì„¤ì •
        this.config = {
            claudeModel: 'claude-sonnet-4-5-20250929',
            alternativeModel: 'claude-opus-4-1-20250805',
            maxTokens: 64000,
            temperature: 0.3,
            topP: 0.9,
            ragTopK: 5,
            ragSimilarityThreshold: 0.7,
            minQualityScore: 95,
            maxRetries: 3
        };

        // ì„¸ì…˜ ì €ì¥ì†Œ
        this.sessions = new Map();  // sessionId â†’ sessionData

        // í†µê³„
        this.stats = {
            totalGenerated: 0,
            successCount: 0,
            failureCount: 0,
            averageQualityScore: 0,
            averageGenerationTime: 0
        };
    }

    // ... ë©”ì„œë“œë“¤
}
```

### 2.2 5ë‹¨ê³„ ìƒì„± í”„ë¡œì„¸ìŠ¤

#### 2.2.1 ë‹¨ê³„ 1: ê²Œì„ ì•„ì´ë””ì–´ ë¶„ì„ (0-20%)

```javascript
async processInitialStage(session, userMessage, context) {
    console.log('ğŸ” 1ë‹¨ê³„: ê²Œì„ ì•„ì´ë””ì–´ ë¶„ì„ ì‹œì‘');

    // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    this.emitProgress(session.id, 5, 'ê²Œì„ ì•„ì´ë””ì–´ ë¶„ì„ ì¤‘...');

    // ì¥ë¥´ ìë™ ë¶„ë¥˜
    const genreAnalysis = await this.genreClassifier.classifyGameIdea(userMessage);

    console.log('ì¥ë¥´ ë¶„ì„ ê²°ê³¼:', genreAnalysis);
    // {
    //   primaryGenre: 'physics',
    //   secondaryGenre: 'sports',
    //   gameType: 'solo',
    //   confidence: 0.85,
    //   suggestedTitle: 'ì„¼ì„œ ë³¼ ê³¨ëŒ€ ê²Œì„',
    //   suggestedMechanics: ['ê¸°ìš¸ê¸° ì œì–´', 'ë¬¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜', 'ëª©í‘œ ë‹¬ì„±']
    // }

    this.emitProgress(session.id, 10, 'ê²Œì„ íƒ€ì… ë¶„ì„ ì™„ë£Œ');

    // ì‹ ë¢°ë„ í™•ì¸
    if (genreAnalysis.confidence > 0.6) {
        // ì¶©ë¶„íˆ ëª…í™•í•¨ â†’ ìë™ ì§„í–‰
        session.stage = 'requirements';
        session.collectedInfo = {
            gameType: genreAnalysis.gameType,
            genre: genreAnalysis.primaryGenre,
            secondaryGenre: genreAnalysis.secondaryGenre,
            title: genreAnalysis.suggestedTitle || userMessage.substring(0, 30),
            mechanics: genreAnalysis.suggestedMechanics,
            description: userMessage
        };

        this.emitProgress(session.id, 20, 'ìš”êµ¬ì‚¬í•­ ìˆ˜ì§‘ ë‹¨ê³„ë¡œ ì´ë™');

        return {
            message: `ë¶„ì„ ì™„ë£Œ! ${genreAnalysis.gameType} ê²Œì„ìœ¼ë¡œ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n` +
                     `ì¥ë¥´: ${genreAnalysis.primaryGenre}\n` +
                     `ì œì•ˆ ì œëª©: ${genreAnalysis.suggestedTitle}\n\n` +
                     `ì¶”ê°€ ìš”êµ¬ì‚¬í•­ì´ ìˆìœ¼ì‹ ê°€ìš”? (ë‚œì´ë„, íŠ¹ìˆ˜ íš¨ê³¼ ë“±)`,
            autoAdvance: true
        };
    } else {
        // ë¶ˆëª…í™• â†’ ì¶”ê°€ ì •ë³´ ìš”ì²­
        this.emitProgress(session.id, 15, 'ì¶”ê°€ ì •ë³´ í•„ìš”');

        return {
            message: `ê²Œì„ ì•„ì´ë””ì–´ë¥¼ ë” ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”:\n\n` +
                     `1. ì–´ë–¤ ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”? (ê¸°ìš¸ê¸°, í”ë“¤ê¸° ë“±)\n` +
                     `2. ê²Œì„ì˜ ëª©í‘œëŠ” ë¬´ì—‡ì¸ê°€ìš”?\n` +
                     `3. 1ì¸ìš©ì¸ê°€ìš”, 2ì¸ìš©ì¸ê°€ìš”?`,
            autoAdvance: false
        };
    }
}
```

#### 2.2.2 ë‹¨ê³„ 2: RAG ë¬¸ì„œ ê²€ìƒ‰ (20-40%)

```javascript
async getRelevantContext(userMessage) {
    console.log('ğŸ“š 2ë‹¨ê³„: RAG ë¬¸ì„œ ê²€ìƒ‰ ì‹œì‘');

    // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    this.emitProgress(session.id, 25, 'RAG ì‹œìŠ¤í…œ ê²€ìƒ‰ ì¤‘...');

    // ì¿¼ë¦¬ ìµœì í™” (ì‚¬ìš©ì ë©”ì‹œì§€ + ì¥ë¥´ ì •ë³´)
    const optimizedQuery = `${userMessage}\n\nì¥ë¥´: ${session.collectedInfo.genre}\nê²Œì„ íƒ€ì…: ${session.collectedInfo.gameType}`;

    // ë²¡í„° ê²€ìƒ‰ (Top-K)
    const results = await this.vectorStore.similaritySearch(
        optimizedQuery,
        this.config.ragTopK
    );

    console.log(`âœ… ${results.length}ê°œ ë¬¸ì„œ ê²€ìƒ‰ ì™„ë£Œ`);

    this.emitProgress(session.id, 35, `${results.length}ê°œ ê´€ë ¨ ë¬¸ì„œ ë°œê²¬`);

    // ìœ ì‚¬ë„ í•„í„°ë§
    const relevantDocs = results.filter(
        doc => doc.score >= this.config.ragSimilarityThreshold
    );

    console.log(`ğŸ“„ í•„í„°ë§ í›„: ${relevantDocs.length}ê°œ ë¬¸ì„œ`);
    relevantDocs.forEach((doc, i) => {
        console.log(`  ${i + 1}. ${doc.metadata.source} (ìœ ì‚¬ë„: ${(doc.score * 100).toFixed(1)}%)`);
    });

    this.emitProgress(session.id, 40, 'RAG ì»¨í…ìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ');

    // ì»¨í…ìŠ¤íŠ¸ ê²°í•©
    const context = relevantDocs.map((doc, i) => {
        return `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“„ ì°¸ì¡° ë¬¸ì„œ ${i + 1}: ${doc.metadata.source}
ìœ ì‚¬ë„: ${(doc.score * 100).toFixed(1)}%
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

${doc.pageContent}

`;
    }).join('\n');

    return {
        context: context,
        documentCount: relevantDocs.length,
        averageSimilarity: relevantDocs.reduce((sum, doc) => sum + doc.score, 0) / relevantDocs.length
    };
}
```

**RAG ê²€ìƒ‰ ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸ“š 2ë‹¨ê³„: RAG ë¬¸ì„œ ê²€ìƒ‰ ì‹œì‘
âœ… 5ê°œ ë¬¸ì„œ ê²€ìƒ‰ ì™„ë£Œ
ğŸ“„ í•„í„°ë§ í›„: 5ê°œ ë¬¸ì„œ
  1. PERFECT_GAME_DEVELOPMENT_GUIDE.md (ìœ ì‚¬ë„: 92.3%)
  2. public/games/cake-delivery/index.html (ìœ ì‚¬ë„: 88.7%)
  3. SESSIONSK_INTEGRATION_PATTERNS.md (ìœ ì‚¬ë„: 85.2%)
  4. public/games/shot-target/index.html (ìœ ì‚¬ë„: 82.1%)
  5. SENSOR_GAME_TROUBLESHOOTING.md (ìœ ì‚¬ë„: 75.8%)
```

#### 2.2.3 ë‹¨ê³„ 3: Claude AI ì½”ë“œ ìƒì„± (40-80%)

```javascript
async generateGameCode(requirements, context) {
    console.log('ğŸ¤– 3ë‹¨ê³„: Claude AI ì½”ë“œ ìƒì„± ì‹œì‘');

    this.emitProgress(session.id, 45, 'AI í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘...');

    // í”„ë¡¬í”„íŠ¸ ìƒì„±
    const prompt = this.buildGameGenerationPrompt(requirements, context);

    console.log(`í”„ë¡¬í”„íŠ¸ ê¸¸ì´: ${prompt.length}ì`);

    this.emitProgress(session.id, 50, 'Claude Sonnet 4.5 í˜¸ì¶œ ì¤‘...');

    // Claude API í˜¸ì¶œ
    const startTime = Date.now();

    const response = await this.anthropicClient.messages.create({
        model: this.config.claudeModel,
        max_tokens: this.config.maxTokens,
        temperature: this.config.temperature,
        top_p: this.config.topP,
        messages: [
            {
                role: 'user',
                content: prompt
            }
        ]
    });

    const elapsedTime = Date.now() - startTime;
    console.log(`â±ï¸ Claude ì‘ë‹µ ì‹œê°„: ${(elapsedTime / 1000).toFixed(2)}ì´ˆ`);

    // í† í° ì‚¬ìš©ëŸ‰
    const inputTokens = response.usage.input_tokens;
    const outputTokens = response.usage.output_tokens;
    const totalTokens = inputTokens + outputTokens;

    console.log(`ğŸ“Š í† í° ì‚¬ìš©ëŸ‰:
  ì…ë ¥: ${inputTokens.toLocaleString()}
  ì¶œë ¥: ${outputTokens.toLocaleString()}
  ì´: ${totalTokens.toLocaleString()}`);

    // ë¹„ìš© ê³„ì‚° (Sonnet 4.5 ê¸°ì¤€)
    const inputCost = (inputTokens / 1000000) * 3;   // $3 / 1M í† í°
    const outputCost = (outputTokens / 1000000) * 15; // $15 / 1M í† í°
    const totalCost = inputCost + outputCost;

    console.log(`ğŸ’° ë¹„ìš©: $${totalCost.toFixed(4)}`);

    this.emitProgress(session.id, 70, 'AI ì‘ë‹µ ìˆ˜ì‹  ì™„ë£Œ, ì½”ë“œ ì¶”ì¶œ ì¤‘...');

    // HTML ì½”ë“œ ì¶”ì¶œ
    const gameCode = this.extractHTMLCode(response.content[0].text);

    if (!gameCode) {
        throw new Error('HTML ì½”ë“œë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }

    console.log(`âœ… ì½”ë“œ ì¶”ì¶œ ì™„ë£Œ: ${gameCode.length}ì`);

    this.emitProgress(session.id, 80, 'ì½”ë“œ ìƒì„± ì™„ë£Œ!');

    return {
        code: gameCode,
        metadata: {
            model: this.config.claudeModel,
            inputTokens: inputTokens,
            outputTokens: outputTokens,
            totalTokens: totalTokens,
            cost: totalCost,
            generationTime: elapsedTime
        }
    };
}

// HTML ì½”ë“œ ì¶”ì¶œ
extractHTMLCode(text) {
    // ```html ... ``` ë¸”ë¡ ì°¾ê¸°
    const htmlBlockRegex = /```html\n([\s\S]*?)\n```/;
    let match = text.match(htmlBlockRegex);

    if (match) {
        return match[1].trim();
    }

    // DOCTYPEìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì½”ë“œ ì°¾ê¸°
    const doctypeRegex = /<!DOCTYPE html>([\s\S]*)/i;
    match = text.match(doctypeRegex);

    if (match) {
        return match[0].trim();
    }

    // <html>ë¡œ ì‹œì‘í•˜ëŠ” ì½”ë“œ ì°¾ê¸°
    const htmlRegex = /<html[^>]*>([\s\S]*)<\/html>/i;
    match = text.match(htmlRegex);

    if (match) {
        return match[0].trim();
    }

    return null;
}
```

**Claude ì‘ë‹µ ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸ¤– 3ë‹¨ê³„: Claude AI ì½”ë“œ ìƒì„± ì‹œì‘
í”„ë¡¬í”„íŠ¸ ê¸¸ì´: 25,432ì
â±ï¸ Claude ì‘ë‹µ ì‹œê°„: 35.23ì´ˆ
ğŸ“Š í† í° ì‚¬ìš©ëŸ‰:
  ì…ë ¥: 8,342
  ì¶œë ¥: 42,158
  ì´: 50,500
ğŸ’° ë¹„ìš©: $0.1575
âœ… ì½”ë“œ ì¶”ì¶œ ì™„ë£Œ: 145,823ì
```

#### 2.2.4 ë‹¨ê³„ 4: ì½”ë“œ ê²€ì¦ (80-90%)

```javascript
async validateGeneratedCode(gameCode, requirements) {
    console.log('âœ”ï¸ 4ë‹¨ê³„: ì½”ë“œ ê²€ì¦ ì‹œì‘');

    this.emitProgress(session.id, 82, 'ì½”ë“œ í’ˆì§ˆ ê²€ì¦ ì¤‘...');

    const validator = new GameValidator();

    // ê²€ì¦ ì‹¤í–‰
    const validation = await validator.validateGameCode(gameCode, {
        gameType: requirements.gameType,
        genre: requirements.genre,
        strictMode: true  // ì—„ê²©í•œ ê²€ì¦
    });

    console.log(`ğŸ“Š ê²€ì¦ ê²°ê³¼:
  ì´ì : ${validation.score}/100
  í†µê³¼: ${validation.passed ? 'âœ… YES' : 'âŒ NO'}
  ì˜¤ë¥˜: ${validation.errors.length}ê°œ
  ê²½ê³ : ${validation.warnings.length}ê°œ`);

    // ìƒì„¸ ê²°ê³¼
    console.log('ìƒì„¸ ì ìˆ˜:');
    console.log(`  HTML êµ¬ì¡°: ${validation.details.structure.score}/20`);
    console.log(`  SessionSDK í†µí•©: ${validation.details.sdk.score}/30`);
    console.log(`  ì„¼ì„œ ì²˜ë¦¬: ${validation.details.sensor.score}/20`);
    console.log(`  ê²Œì„ ë¡œì§: ${validation.details.gameLogic.score}/15`);
    console.log(`  UI/UX: ${validation.details.ui.score}/15`);

    this.emitProgress(session.id, 88, `ê²€ì¦ ì™„ë£Œ (ì ìˆ˜: ${validation.score}ì )`);

    // í’ˆì§ˆ ê¸°ì¤€ í™•ì¸
    if (validation.score < this.config.minQualityScore) {
        console.log(`âŒ í’ˆì§ˆ ë¯¸ë‹¬: ${validation.score}ì  (ìµœì†Œ: ${this.config.minQualityScore}ì )`);

        // ì¬ì‹œë„ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
        if (session.retryCount < this.config.maxRetries) {
            console.log(`ğŸ”„ ì¬ì‹œë„ ${session.retryCount + 1}/${this.config.maxRetries}`);

            this.emitProgress(session.id, 85, `í’ˆì§ˆ ë¯¸ë‹¬, ì¬ìƒì„± ì¤‘... (${session.retryCount + 1}/${this.config.maxRetries})`);

            throw new Error(`í’ˆì§ˆ ë¯¸ë‹¬: ${validation.score}ì  (ì¬ì‹œë„ í•„ìš”)`);
        } else {
            console.log(`âŒ ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼`);
            throw new Error(`í’ˆì§ˆ ë¯¸ë‹¬: ${validation.score}ì  (ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼)`);
        }
    }

    console.log(`âœ… ê²€ì¦ í†µê³¼! (${validation.score}ì )`);

    return validation;
}
```

**ê²€ì¦ ë¡œê·¸ ì˜ˆì‹œ**:
```
âœ”ï¸ 4ë‹¨ê³„: ì½”ë“œ ê²€ì¦ ì‹œì‘
ğŸ“Š ê²€ì¦ ê²°ê³¼:
  ì´ì : 97/100
  í†µê³¼: âœ… YES
  ì˜¤ë¥˜: 0ê°œ
  ê²½ê³ : 1ê°œ
ìƒì„¸ ì ìˆ˜:
  HTML êµ¬ì¡°: 20/20
  SessionSDK í†µí•©: 29/30 (ê²½ê³ : QR ì½”ë“œ í´ë°± ê¶Œì¥)
  ì„¼ì„œ ì²˜ë¦¬: 20/20
  ê²Œì„ ë¡œì§: 14/15
  UI/UX: 14/15
âœ… ê²€ì¦ í†µê³¼! (97ì )
```

#### 2.2.5 ë‹¨ê³„ 5: íŒŒì¼ ì €ì¥ ë° ë“±ë¡ (90-100%)

```javascript
async saveAndRegisterGame(gameId, gameCode, requirements, validation) {
    console.log('ğŸ’¾ 5ë‹¨ê³„: íŒŒì¼ ì €ì¥ ë° ë“±ë¡ ì‹œì‘');

    this.emitProgress(session.id, 92, 'ë¡œì»¬ íŒŒì¼ ì €ì¥ ì¤‘...');

    // 1. ë¡œì»¬ íŒŒì¼ ì €ì¥
    const gamePath = path.join(__dirname, '../public/games', gameId);
    const indexPath = path.join(gamePath, 'index.html');

    await fs.mkdir(gamePath, { recursive: true });
    await fs.writeFile(indexPath, gameCode, 'utf-8');

    console.log(`âœ… ë¡œì»¬ ì €ì¥: ${indexPath}`);

    this.emitProgress(session.id, 94, 'Supabase Storage ì—…ë¡œë“œ ì¤‘...');

    // 2. Supabase Storage ì—…ë¡œë“œ
    const { error: storageError } = await this.supabaseAdminClient
        .storage
        .from('games')
        .upload(`${gameId}/index.html`, gameCode, {
            contentType: 'text/html',
            upsert: true
        });

    if (storageError) {
        console.error('âŒ Storage ì—…ë¡œë“œ ì‹¤íŒ¨:', storageError);
    } else {
        console.log('âœ… Storage ì—…ë¡œë“œ ì™„ë£Œ');
    }

    this.emitProgress(session.id, 96, 'DB ë©”íƒ€ë°ì´í„° ë“±ë¡ ì¤‘...');

    // 3. DB ë©”íƒ€ë°ì´í„° ë“±ë¡
    const { data: gameData, error: dbError } = await this.supabaseAdminClient
        .from('generated_games')
        .insert({
            game_id: gameId,
            title: requirements.title,
            description: requirements.description,
            game_type: requirements.gameType,
            genre: requirements.genre,
            storage_path: `${gameId}/index.html`,
            creator_id: requirements.creatorId,  // ê¶Œí•œ ê´€ë¦¬
            metadata: {
                version: '1.0',
                validationScore: validation.score,
                generationMetadata: validation.metadata
            }
        })
        .select()
        .single();

    if (dbError) {
        console.error('âŒ DB ë“±ë¡ ì‹¤íŒ¨:', dbError);
        throw dbError;
    }

    console.log('âœ… DB ë“±ë¡ ì™„ë£Œ');

    this.emitProgress(session.id, 98, 'ìœ ì§€ë³´ìˆ˜ ì‹œìŠ¤í…œ ë“±ë¡ ì¤‘...');

    // 4. GameMaintenanceManager ìë™ ë“±ë¡
    if (this.gameMaintenanceManager) {
        this.gameMaintenanceManager.registerGameSession(gameId, {
            title: requirements.title,
            description: requirements.description,
            gameType: requirements.gameType,
            genre: requirements.genre,
            version: '1.0',
            createdAt: new Date().toISOString(),
            modifications: []
        });

        console.log('âœ… ìœ ì§€ë³´ìˆ˜ ì‹œìŠ¤í…œ ë“±ë¡ ì™„ë£Œ');
    }

    this.emitProgress(session.id, 99, 'GameScanner ì¬ìŠ¤ìº” ì¤‘...');

    // 5. GameScanner ì¬ìŠ¤ìº”
    if (this.gameScanner) {
        await this.gameScanner.scanGames();
        console.log('âœ… GameScanner ì¬ìŠ¤ìº” ì™„ë£Œ');
    }

    this.emitProgress(session.id, 100, 'ğŸ‰ ê²Œì„ ìƒì„± ì™„ë£Œ!');

    console.log(`ğŸ‰ ê²Œì„ ìƒì„± ì™„ë£Œ: ${gameId}`);

    // í†µê³„ ì—…ë°ì´íŠ¸
    this.stats.totalGenerated++;
    this.stats.successCount++;
    this.stats.averageQualityScore =
        (this.stats.averageQualityScore * (this.stats.totalGenerated - 1) + validation.score) / this.stats.totalGenerated;

    return {
        gameId: gameId,
        title: requirements.title,
        path: `/games/${gameId}`,
        url: `${process.env.PUBLIC_URL || 'http://localhost:3000'}/games/${gameId}`,
        validationScore: validation.score
    };
}
```

**ì €ì¥ ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸ’¾ 5ë‹¨ê³„: íŒŒì¼ ì €ì¥ ë° ë“±ë¡ ì‹œì‘
âœ… ë¡œì»¬ ì €ì¥: /Users/dev/ì¡¸ì—…ì‘í’ˆ/sensorchatbot/public/games/sensor-ball-game-abc123/index.html
âœ… Storage ì—…ë¡œë“œ ì™„ë£Œ
âœ… DB ë“±ë¡ ì™„ë£Œ
âœ… ìœ ì§€ë³´ìˆ˜ ì‹œìŠ¤í…œ ë“±ë¡ ì™„ë£Œ
âœ… GameScanner ì¬ìŠ¤ìº” ì™„ë£Œ
ğŸ‰ ê²Œì„ ìƒì„± ì™„ë£Œ: sensor-ball-game-abc123
```

---

## 3. RAG ì‹œìŠ¤í…œ êµ¬í˜„

### 3.1 DocumentEmbedder

```javascript
// server/DocumentEmbedder.js (647ì¤„)
class DocumentEmbedder {
    constructor() {
        // OpenAI ì„ë² ë”©
        this.embeddings = new OpenAIEmbeddings({
            modelName: 'text-embedding-3-small',
            apiKey: process.env.OPENAI_API_KEY,
            dimensions: 1536
        });

        // Supabase í´ë¼ì´ì–¸íŠ¸
        this.supabase = createClient(
            process.env.SUPABASE_URL,
            process.env.SUPABASE_SERVICE_ROLE_KEY
        );

        // í…ìŠ¤íŠ¸ ë¶„í• ê¸°
        this.textSplitter = new RecursiveCharacterTextSplitter({
            chunkSize: 1000,     // 1000ì ë‹¨ìœ„
            chunkOverlap: 200    // 200ì ì˜¤ë²„ë©
        });

        // ë¬¸ì„œ ê²½ë¡œ
        this.documentPaths = [
            // í•µì‹¬ ê°€ì´ë“œ
            'docs/PERFECT_GAME_DEVELOPMENT_GUIDE.md',
            'docs/PERFECT_GAME_EXAMPLES.md',
            'docs/SESSIONSK_INTEGRATION_PATTERNS.md',
            'docs/SENSOR_GAME_TROUBLESHOOTING.md',

            // ê°œë°œ ê°€ì´ë“œ
            'docs/game-development/01-architecture-design.md',
            'docs/game-development/02-sessionsdk-advanced.md',
            'docs/game-development/03-sensor-data-mastery.md',
            'docs/game-development/04-physics-engine.md',
            'docs/game-development/05-ui-ux-patterns.md',
            'docs/game-development/06-performance-optimization.md',

            // ê²Œì„ íƒ€ì…ë³„ ê°€ì´ë“œ
            'docs/game-types/solo-game-guide.md',
            'docs/game-types/dual-game-guide.md',
            'docs/game-types/multi-game-guide.md',

            // ê²€ì¦ëœ ê²Œì„ ì½”ë“œ
            'public/games/cake-delivery/index.html',  // A+ ê²Œì„
            'public/games/shot-target/index.html',    // A+ ê²Œì„
            'public/games/acorn-battle/index.html',
            'public/games/quick-draw/index.html',

            // ê¸°íƒ€ 18ê°œ ë¬¸ì„œ...
        ];
    }

    // ì „ì²´ ë¬¸ì„œ ì„ë² ë”©
    async embedAllDocuments() {
        console.log('ğŸ“š ë¬¸ì„œ ì„ë² ë”© ì‹œì‘...');

        const allDocuments = [];

        // 1. ë¬¸ì„œ ë¡œë“œ
        for (const docPath of this.documentPaths) {
            const fullPath = path.join(__dirname, '..', docPath);

            try {
                const content = await fs.readFile(fullPath, 'utf-8');

                allDocuments.push({
                    pageContent: content,
                    metadata: {
                        source: docPath,
                        type: this.getDocumentType(docPath),
                        size: content.length
                    }
                });

                console.log(`âœ… ë¡œë“œ: ${docPath} (${content.length}ì)`);
            } catch (error) {
                console.error(`âŒ ë¡œë“œ ì‹¤íŒ¨: ${docPath}`, error.message);
            }
        }

        console.log(`ğŸ“„ ì´ ${allDocuments.length}ê°œ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ`);

        // 2. í…ìŠ¤íŠ¸ ì²­í‚¹
        console.log('âœ‚ï¸ í…ìŠ¤íŠ¸ ì²­í‚¹ ì‹œì‘...');

        const chunks = await this.textSplitter.splitDocuments(allDocuments);

        console.log(`âœ… ${chunks.length}ê°œ ì²­í¬ ìƒì„± ì™„ë£Œ`);
        console.log(`í‰ê·  ì²­í¬ í¬ê¸°: ${Math.round(chunks.reduce((sum, chunk) => sum + chunk.pageContent.length, 0) / chunks.length)}ì`);

        // 3. ë°°ì¹˜ ì„ë² ë”© (íš¨ìœ¨ì„±)
        console.log('ğŸ”¢ ì„ë² ë”© ìƒì„± ì‹œì‘...');

        const batchSize = 100;
        let embeddedCount = 0;

        for (let i = 0; i < chunks.length; i += batchSize) {
            const batch = chunks.slice(i, i + batchSize);

            // ì„ë² ë”© ìƒì„±
            const texts = batch.map(chunk => chunk.pageContent);
            const embeddings = await this.embeddings.embedDocuments(texts);

            // Supabaseì— ì €ì¥
            const records = batch.map((chunk, j) => ({
                content: chunk.pageContent,
                metadata: chunk.metadata,
                embedding: embeddings[j]
            }));

            const { error } = await this.supabase
                .from('game_knowledge')
                .insert(records);

            if (error) {
                console.error(`âŒ ë°°ì¹˜ ${i / batchSize + 1} ì €ì¥ ì‹¤íŒ¨:`, error);
            } else {
                embeddedCount += batch.length;
                console.log(`âœ… ${embeddedCount}/${chunks.length} ì„ë² ë”© ì™„ë£Œ`);
            }
        }

        console.log('ğŸ‰ ì „ì²´ ì„ë² ë”© ì™„ë£Œ!');

        return {
            documentCount: allDocuments.length,
            chunkCount: chunks.length,
            embeddedCount: embeddedCount
        };
    }

    // ë¬¸ì„œ íƒ€ì… ë¶„ë¥˜
    getDocumentType(docPath) {
        if (docPath.includes('PERFECT_GAME')) return 'guide';
        if (docPath.includes('SESSIONSK')) return 'sdk';
        if (docPath.includes('game-development')) return 'tutorial';
        if (docPath.includes('public/games')) return 'example';
        if (docPath.includes('troubleshooting')) return 'troubleshooting';
        return 'other';
    }
}
```

**ì„ë² ë”© ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸ“š ë¬¸ì„œ ì„ë² ë”© ì‹œì‘...
âœ… ë¡œë“œ: docs/PERFECT_GAME_DEVELOPMENT_GUIDE.md (125,432ì)
âœ… ë¡œë“œ: docs/PERFECT_GAME_EXAMPLES.md (87,234ì)
... (28ê°œ ë¬¸ì„œ)
ğŸ“„ ì´ 28ê°œ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ
âœ‚ï¸ í…ìŠ¤íŠ¸ ì²­í‚¹ ì‹œì‘...
âœ… 412ê°œ ì²­í¬ ìƒì„± ì™„ë£Œ
í‰ê·  ì²­í¬ í¬ê¸°: 987ì
ğŸ”¢ ì„ë² ë”© ìƒì„± ì‹œì‘...
âœ… 100/412 ì„ë² ë”© ì™„ë£Œ
âœ… 200/412 ì„ë² ë”© ì™„ë£Œ
âœ… 300/412 ì„ë² ë”© ì™„ë£Œ
âœ… 400/412 ì„ë² ë”© ì™„ë£Œ
âœ… 412/412 ì„ë² ë”© ì™„ë£Œ
ğŸ‰ ì „ì²´ ì„ë² ë”© ì™„ë£Œ!
```

### 3.2 ë²¡í„° ê²€ìƒ‰ SQL í•¨ìˆ˜

```sql
-- Supabaseì—ì„œ ì‹¤í–‰
CREATE OR REPLACE FUNCTION match_documents(
    query_embedding vector(1536),
    match_count INT DEFAULT 5,
    similarity_threshold FLOAT DEFAULT 0.7
)
RETURNS TABLE (
    content TEXT,
    metadata JSONB,
    similarity FLOAT
)
LANGUAGE plpgsql
AS $$
BEGIN
    RETURN QUERY
    SELECT
        game_knowledge.content,
        game_knowledge.metadata,
        1 - (game_knowledge.embedding <=> query_embedding) AS similarity
    FROM game_knowledge
    WHERE 1 - (game_knowledge.embedding <=> query_embedding) > similarity_threshold
    ORDER BY similarity DESC
    LIMIT match_count;
END;
$$;
```

**ë²¡í„° ê²€ìƒ‰ ì„±ëŠ¥**:
```
ë°ì´í„°ì…‹ í¬ê¸°: 412ê°œ ì²­í¬
ê²€ìƒ‰ ì‹œê°„: í‰ê·  1.2ì´ˆ
ì •í™•ë„: 92%
ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ~650MB (ì„ë² ë”© ì €ì¥)
```

---

## 4. í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§

### 4.1 ê²Œì„ ìƒì„± í”„ë¡¬í”„íŠ¸

```javascript
buildGameGenerationPrompt(requirements, context) {
    return `
ğŸ® Sensor Game Hub - AI ê²Œì„ ìƒì„± ì‹œìŠ¤í…œ v6.1

ë‹¹ì‹ ì€ **ê²€ì¦ëœ ì„¼ì„œ ê²Œì„ ê°œë°œ ì „ë¬¸ê°€**ì…ë‹ˆë‹¤.
ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” **ì™„ë²½í•œ HTML ê²Œì„ ì½”ë“œ**ë¥¼ ìƒì„±í•˜ì„¸ìš”.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ **ê²Œì„ ìš”êµ¬ì‚¬í•­:**
- ì œëª©: ${requirements.title}
- ì„¤ëª…: ${requirements.description}
- ê²Œì„ íƒ€ì…: ${requirements.gameType} (solo/dual/multi)
- ì¥ë¥´: ${requirements.genre}
- ë‚œì´ë„: ${requirements.difficulty || 'ë³´í†µ'}
- ì¶”ê°€ ìš”êµ¬ì‚¬í•­: ${requirements.additionalRequirements || 'ì—†ìŒ'}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”¥ **í•„ìˆ˜ êµ¬í˜„ íŒ¨í„´ (ê²€ì¦ëœ shot-target, cake-delivery ê¸°ë°˜):**

1. **SessionSDK í†µí•© (í•„ìˆ˜!)**
\`\`\`javascript
// âœ… ì˜¬ë°”ë¥¸ íŒ¨í„´
const sdk = new SessionSDK({
    gameId: '${requirements.gameId}',
    gameType: '${requirements.gameType}',
    debug: true
});

// âš ï¸ ì¤‘ìš”: ì„œë²„ ì—°ê²° ì™„ë£Œ í›„ ì„¸ì…˜ ìƒì„±
sdk.on('connected', async () => {
    const session = await sdk.createSession();
});

// âš ï¸ ì¤‘ìš”: CustomEvent íŒ¨í„´ (event.detail || event)
sdk.on('session-created', (event) => {
    const session = event.detail || event;  // ğŸ”¥ í•„ìˆ˜!

    // ì„¸ì…˜ ì½”ë“œ í‘œì‹œ
    document.getElementById('session-code').textContent = session.sessionCode;

    // QR ì½”ë“œ ìƒì„± (URL ì§ì ‘ ìƒì„±!)
    const qrUrl = \`\${window.location.origin}/sensor.html?session=\${session.sessionCode}\`;
    generateQRCode(qrUrl);
});

sdk.on('sensor-data', (event) => {
    const data = event.detail || event;  // ğŸ”¥ í•„ìˆ˜!
    processSensorData(data);
});
\`\`\`

2. **ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬:**
\`\`\`javascript
function processSensorData(sensorData) {
    const { orientation, acceleration } = sensorData.data;

    // gamma: ì¢Œìš° ê¸°ìš¸ê¸° (-90 ~ 90)
    // beta: ì•ë’¤ ê¸°ìš¸ê¸° (-180 ~ 180)
    const tiltX = orientation.gamma / 90;   // -1 ~ 1 ì •ê·œí™”
    const tiltY = orientation.beta / 180;   // -1 ~ 1 ì •ê·œí™”

    // ê²Œì„ ë¡œì§ ì ìš©
    player.x += tiltX * speed;
    player.y += tiltY * speed;
}
\`\`\`

3. **ê²Œì„ ë¡œì§ êµ¬ì¡°:**
\`\`\`javascript
let gameState = {
    status: 'waiting',  // waiting, playing, paused, ended
    score: 0,
    time: 0,
    // ... ê²Œì„ë³„ ìƒíƒœ
};

function gameLoop() {
    if (gameState.status !== 'playing') return;

    // 1. ì—…ë°ì´íŠ¸
    updateGame();

    // 2. ë Œë”ë§
    renderGame();

    // 3. ë‹¤ìŒ í”„ë ˆì„
    requestAnimationFrame(gameLoop);
}
\`\`\`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š **ê°œë°œ ì°¸ê³ ìë£Œ (RAG ê²€ìƒ‰ ê²°ê³¼ - Top ${this.config.ragTopK}):**

${context.context}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš¨ **ì ˆëŒ€ì  ìš”êµ¬ì‚¬í•­ (Checklist):**
[ ] 1. ë‹¨ì¼ HTML íŒŒì¼ë¡œ ì™„ì„± (ëª¨ë“  CSS/JS ì¸ë¼ì¸)
[ ] 2. session.sessionCode ì‚¬ìš© (session.code ì•„ë‹˜!)
[ ] 3. QR URL ì§ì ‘ ìƒì„± (\`\${origin}/sensor.html?session=\${code}\`)
[ ] 4. QR ì½”ë“œê°€ ì‹¤ì œë¡œ ìƒì„±ë˜ê³  í‘œì‹œë¨ (í´ë°± í¬í•¨)
[ ] 5. ì„¼ì„œ ì—°ê²° ì‹œ ê²Œì„ì´ ì‹¤ì œë¡œ í”Œë ˆì´ ê°€ëŠ¥í•¨
[ ] 6. CustomEvent íŒ¨í„´ (event.detail || event) ë°˜ë“œì‹œ ì‚¬ìš©
[ ] 7. ${requirements.genre} ì¥ë¥´ íŠ¹ì„±ì„ ì™„ë²½íˆ ë°˜ì˜
[ ] 8. ${requirements.gameType} ê²Œì„ íƒ€ì…ì— ë§ëŠ” ì„¼ì„œ ê°œìˆ˜ (solo: 1, dual: 2, multi: 10)
[ ] 9. Canvas ì‚¬ìš© (HTML5 Canvas API)
[ ] 10. 60fps ë¶€ë“œëŸ¬ìš´ ë Œë”ë§ (requestAnimationFrame)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ **ì¶”ê°€ ê°€ì´ë“œ:**

**UI êµ¬ì¡°:**
- ëŒ€ê¸° í™”ë©´: ì„¸ì…˜ ì½”ë“œ, QR ì½”ë“œ, "ì„¼ì„œë¥¼ ì—°ê²°í•˜ì„¸ìš”" ë©”ì‹œì§€
- ê²Œì„ í™”ë©´: Canvas (ì „ì²´ í™”ë©´), ì ìˆ˜ íŒ¨ë„, ì‹œê°„ í‘œì‹œ
- ì¢…ë£Œ í™”ë©´: ìµœì¢… ì ìˆ˜, "ë‹¤ì‹œ í•˜ê¸°" ë²„íŠ¼

**ìŠ¤íƒ€ì¼ ê°€ì´ë“œ:**
- ë‹¤í¬ í…Œë§ˆ (ë°°ê²½: #1F2937, í…ìŠ¤íŠ¸: #F9FAFB)
- í˜„ëŒ€ì ì¸ UI (ë‘¥ê·¼ ëª¨ì„œë¦¬, ê·¸ë¦¼ì, ì• ë‹ˆë©”ì´ì…˜)
- ëª¨ë°”ì¼ ì¹œí™”ì  (ë°˜ì‘í˜•, í„°ì¹˜ ì§€ì›)

**ì„±ëŠ¥ ìµœì í™”:**
- ì˜¤í”„ìŠ¤í¬ë¦° ìº”ë²„ìŠ¤ (ë°°ê²½ ìºì‹±)
- ë”í‹° ë ‰íŠ¸ (ë¶€ë¶„ ë Œë”ë§)
- ê°ì²´ í’€ë§ (ë©”ëª¨ë¦¬ ì¬ì‚¬ìš©)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ì™„ì „íˆ ì‘ë™í•˜ëŠ” ê²Œì„ HTML ì½”ë“œë¥¼ ìƒì„±í•˜ì„¸ìš”:
`;
}
```

### 4.2 í”„ë¡¬í”„íŠ¸ ìµœì í™” ê¸°ë²•

**1. ì—­í•  ëª…ì‹œ (Role-Playing)**
```
ë‹¹ì‹ ì€ **ê²€ì¦ëœ ì„¼ì„œ ê²Œì„ ê°œë°œ ì „ë¬¸ê°€**ì…ë‹ˆë‹¤.
```
â†’ AIê°€ ì „ë¬¸ê°€ ê´€ì ì—ì„œ ì‘ë‹µí•˜ë„ë¡ ìœ ë„

**2. ì˜ˆì œ ê¸°ë°˜ í•™ìŠµ (Few-Shot)**
```javascript
// âœ… ì˜¬ë°”ë¥¸ íŒ¨í„´
const session = event.detail || event;

// âŒ ì˜ëª»ëœ íŒ¨í„´
const session = event;
```
â†’ ì˜¬ë°”ë¥¸ íŒ¨í„´ê³¼ ì˜ëª»ëœ íŒ¨í„´ì„ ëª…ì‹œ

**3. ì²´í¬ë¦¬ìŠ¤íŠ¸ (Checklist)**
```
[ ] 1. ë‹¨ì¼ HTML íŒŒì¼ë¡œ ì™„ì„±
[ ] 2. session.sessionCode ì‚¬ìš©
...
```
â†’ AIê°€ ëª¨ë“  ìš”êµ¬ì‚¬í•­ì„ í™•ì¸í•˜ë„ë¡ ìœ ë„

**4. RAG ì»¨í…ìŠ¤íŠ¸ í†µí•©**
```
ğŸ“š ê°œë°œ ì°¸ê³ ìë£Œ (RAG ê²€ìƒ‰ ê²°ê³¼ - Top 5):
[ê²€ì¦ëœ ê²Œì„ ì½”ë“œ ë° ê°€ì´ë“œ]
```
â†’ ê²€ì¦ëœ íŒ¨í„´ì„ ì°¸ì¡°í•˜ë„ë¡ ìœ ë„

**5. ì˜¨ë„ ì¡°ì ˆ (Temperature)**
```javascript
temperature: 0.3  // ì¼ê´€ì„± ê°•í™” (0.1-0.5)
```
â†’ ë‚®ì€ ì˜¨ë„ë¡œ ê²°ì •ë¡ ì  ì¶œë ¥

---

## 5. GameMaintenanceManager

### 5.1 ë²„ê·¸ ìˆ˜ì • ì‹œìŠ¤í…œ

```javascript
// server/GameMaintenanceManager.js (962ì¤„)
async fixBug(gameId, bugReport, userId) {
    console.log(`ğŸ› ë²„ê·¸ ìˆ˜ì • ì‹œì‘: ${gameId}`);

    // 1. ê¶Œí•œ ê²€ì¦
    const hasPermission = await this.checkPermission(gameId, userId);
    if (!hasPermission) {
        throw new Error('ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë³¸ì¸ì´ ìƒì„±í•œ ê²Œì„ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }

    // 2. í˜„ì¬ ì½”ë“œ ì½ê¸°
    const { code, source } = await this.readGameCode(gameId);
    console.log(`âœ… ì½”ë“œ ë¡œë“œ ì™„ë£Œ: ${code.length}ì (ì¶œì²˜: ${source})`);

    // 3. DBì—ì„œ ë²„ì „ ì •ë³´ ì¡°íšŒ
    const { data: versionInfo } = await this.supabase
        .from('game_versions')
        .select('*')
        .eq('game_id', gameId)
        .single();

    const currentVersion = versionInfo?.current_version || '1.0';
    console.log(`í˜„ì¬ ë²„ì „: ${currentVersion}`);

    // 4. ë²„ì „ ë°±ì—…
    await this.createBackup(gameId, code, currentVersion);
    console.log('âœ… ë°±ì—… ìƒì„± ì™„ë£Œ');

    // 5. Claude AIë¡œ ë²„ê·¸ ìˆ˜ì •
    console.log('ğŸ¤– Claude AI ë²„ê·¸ ë¶„ì„ ì¤‘...');

    const fixedCode = await this.generateBugFix(code, bugReport, {
        gameId,
        currentVersion,
        source
    });

    console.log('âœ… ë²„ê·¸ ìˆ˜ì • ì½”ë“œ ìƒì„± ì™„ë£Œ');

    // 6. ìˆ˜ì •ëœ ì½”ë“œ ì €ì¥
    await this.saveGameCode(gameId, fixedCode);
    console.log('âœ… ìˆ˜ì •ëœ ì½”ë“œ ì €ì¥ ì™„ë£Œ');

    // 7. ë²„ì „ ì¦ê°€
    const newVersion = this.incrementVersion(currentVersion, 'patch');
    console.log(`ë²„ì „ ì¦ê°€: ${currentVersion} â†’ ${newVersion}`);

    // 8. DB ë²„ì „ ì •ë³´ ì—…ë°ì´íŠ¸
    await this.updateVersionInDB(gameId, newVersion, {
        type: 'bugfix',
        description: bugReport,
        timestamp: new Date().toISOString(),
        previousVersion: currentVersion
    });

    console.log('âœ… DB ì—…ë°ì´íŠ¸ ì™„ë£Œ');

    // 9. ì„¸ì…˜ ì—…ë°ì´íŠ¸
    const session = this.getSession(gameId);
    if (session) {
        session.version = newVersion;
        session.modifications.push({
            type: 'bugfix',
            description: bugReport,
            timestamp: new Date().toISOString()
        });
    }

    console.log(`ğŸ‰ ë²„ê·¸ ìˆ˜ì • ì™„ë£Œ: ${gameId} (v${newVersion})`);

    return { newVersion, fixed: true };
}

// Claude AI ë²„ê·¸ ìˆ˜ì • í”„ë¡¬í”„íŠ¸
async generateBugFix(code, bugReport, metadata) {
    const prompt = `
ğŸ› ë²„ê·¸ ìˆ˜ì • ì „ë¬¸ê°€ ëª¨ë“œ

ë‹¤ìŒ ê²Œì„ ì½”ë“œì—ì„œ ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ê²Œì„ ì •ë³´:
- ê²Œì„ ID: ${metadata.gameId}
- í˜„ì¬ ë²„ì „: ${metadata.currentVersion}

ë²„ê·¸ ë¦¬í¬íŠ¸:
${bugReport}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

í˜„ì¬ ì½”ë“œ:
\`\`\`html
${code}
\`\`\`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ìˆ˜ì • ê°€ì´ë“œ:
1. ë²„ê·¸ë¥¼ ì •í™•íˆ ë¶„ì„í•˜ì„¸ìš”.
2. **ìµœì†Œí•œì˜ ë³€ê²½**ìœ¼ë¡œ ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.
3. ê¸°ì¡´ ê¸°ëŠ¥ì„ ì ˆëŒ€ ì†ìƒì‹œí‚¤ì§€ ë§ˆì„¸ìš”.
4. ì£¼ì„ìœ¼ë¡œ ìˆ˜ì • ì‚¬í•­ì„ ëª…ì‹œí•˜ì„¸ìš”.

ìˆ˜ì •ëœ ì™„ì „í•œ HTML ì½”ë“œë¥¼ ì¶œë ¥í•˜ì„¸ìš”:
`;

    const response = await this.anthropicClient.messages.create({
        model: 'claude-sonnet-4-5-20250929',
        max_tokens: 64000,
        temperature: 0.2,  // ë³´ìˆ˜ì ì¸ ìˆ˜ì •
        messages: [{ role: 'user', content: prompt }]
    });

    return this.extractHTMLCode(response.content[0].text);
}
```

**ë²„ê·¸ ìˆ˜ì • ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸ› ë²„ê·¸ ìˆ˜ì • ì‹œì‘: sensor-ball-game-abc123
âœ… ì½”ë“œ ë¡œë“œ ì™„ë£Œ: 145,823ì (ì¶œì²˜: local)
í˜„ì¬ ë²„ì „: 1.0
âœ… ë°±ì—… ìƒì„± ì™„ë£Œ
ğŸ¤– Claude AI ë²„ê·¸ ë¶„ì„ ì¤‘...
âœ… ë²„ê·¸ ìˆ˜ì • ì½”ë“œ ìƒì„± ì™„ë£Œ
âœ… ìˆ˜ì •ëœ ì½”ë“œ ì €ì¥ ì™„ë£Œ
ë²„ì „ ì¦ê°€: 1.0 â†’ 1.1
âœ… DB ì—…ë°ì´íŠ¸ ì™„ë£Œ
ğŸ‰ ë²„ê·¸ ìˆ˜ì • ì™„ë£Œ: sensor-ball-game-abc123 (v1.1)
```

### 5.2 ê¸°ëŠ¥ ì¶”ê°€ ì‹œìŠ¤í…œ

```javascript
async addFeature(gameId, featureRequest, userId) {
    console.log(`âœ¨ ê¸°ëŠ¥ ì¶”ê°€ ì‹œì‘: ${gameId}`);

    // (ê¶Œí•œ ê²€ì¦, ì½”ë“œ ë¡œë“œ, ë°±ì—… ë“±ì€ fixBugì™€ ë™ì¼)

    // Claude AIë¡œ ê¸°ëŠ¥ ì¶”ê°€ (ì¦ë¶„ ì—…ë°ì´íŠ¸)
    console.log('ğŸ¤– Claude AI ê¸°ëŠ¥ ì¶”ê°€ ì¤‘...');

    const updatedCode = await this.generateFeatureAddition(code, featureRequest, {
        gameId,
        currentVersion,
        incrementalUpdate: true  // âœ… í•µì‹¬: ì¦ë¶„ ì—…ë°ì´íŠ¸
    });

    // ë²„ì „ ì¦ê°€: minor (ì˜ˆ: 1.1 â†’ 1.2)
    const newVersion = this.incrementVersion(currentVersion, 'minor');

    // (ì €ì¥, DB ì—…ë°ì´íŠ¸ ë“±)

    return { newVersion, added: true };
}

// Claude AI ê¸°ëŠ¥ ì¶”ê°€ í”„ë¡¬í”„íŠ¸
async generateFeatureAddition(code, featureRequest, metadata) {
    const prompt = `
âœ¨ ê¸°ëŠ¥ ì¶”ê°€ ì „ë¬¸ê°€ ëª¨ë“œ

ë‹¤ìŒ ê²Œì„ ì½”ë“œì— ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì„¸ìš”.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ê²Œì„ ì •ë³´:
- ê²Œì„ ID: ${metadata.gameId}
- í˜„ì¬ ë²„ì „: ${metadata.currentVersion}

ê¸°ëŠ¥ ìš”ì²­:
${featureRequest}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

í˜„ì¬ ì½”ë“œ:
\`\`\`html
${code}
\`\`\`

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ì¶”ê°€ ê°€ì´ë“œ:
1. **ì¦ë¶„ ì—…ë°ì´íŠ¸**: ì „ì²´ë¥¼ ì¬ì‘ì„±í•˜ì§€ ë§ê³ , ê¸°ì¡´ ì½”ë“œì— ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì„¸ìš”.
2. **í•˜ìœ„ í˜¸í™˜ì„±**: ê¸°ì¡´ ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤.
3. **ì¼ê´€ì„±**: ê¸°ì¡´ ì½”ë“œ ìŠ¤íƒ€ì¼ê³¼ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ì„¸ìš”.
4. **ì£¼ì„**: ì¶”ê°€ëœ ê¸°ëŠ¥ì„ ì£¼ì„ìœ¼ë¡œ ëª…ì‹œí•˜ì„¸ìš”.

ì—…ë°ì´íŠ¸ëœ ì™„ì „í•œ HTML ì½”ë“œë¥¼ ì¶œë ¥í•˜ì„¸ìš”:
`;

    const response = await this.anthropicClient.messages.create({
        model: 'claude-sonnet-4-5-20250929',
        max_tokens: 64000,
        temperature: 0.3,
        messages: [{ role: 'user', content: prompt }]
    });

    return this.extractHTMLCode(response.content[0].text);
}
```

---

## 6. Claude Sonnet 4.5 í™œìš©ë²•

### 6.1 ëª¨ë¸ íŠ¹ì„±

**Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)**

| í•­ëª© | ê°’ |
|------|-----|
| **ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš°** | 200,000 í† í° (ì…ë ¥) |
| **ì¶œë ¥ í† í°** | 64,000 í† í° â­ |
| **ë¹„ìš© (ì…ë ¥)** | $3 / 1M í† í° |
| **ë¹„ìš© (ì¶œë ¥)** | $15 / 1M í† í° |
| **ê°•ì ** | ì½”ë“œ ìƒì„±, ì§€ì‹œ ë”°ë¥´ê¸° |

### 6.2 ìµœì  ì„¤ì •

```javascript
{
    model: 'claude-sonnet-4-5-20250929',
    max_tokens: 64000,           // ìµœëŒ€ í™œìš©
    temperature: 0.3,            // ì¼ê´€ì„± (0.1-0.5)
    top_p: 0.9,                  // í’ˆì§ˆ ìš°ì„ 
    messages: [...]
}
```

**Temperature ê°€ì´ë“œ**:
- **0.1-0.3**: ê²°ì •ë¡ ì , ì¼ê´€ì„± ì¤‘ìš” (ê²Œì„ ìƒì„±)
- **0.4-0.6**: ê· í˜• (ì¼ë°˜ ì‘ì—…)
- **0.7-1.0**: ì°½ì˜ì  (ì•„ì´ë””ì–´ ìƒì„±)

### 6.3 í† í° ìµœì í™”

**1. í”„ë¡¬í”„íŠ¸ ì••ì¶•**
```javascript
// âŒ ë¹„íš¨ìœ¨ì  (10,000 í† í°)
const prompt = `
[ê¸´ ë°˜ë³µì ì¸ ì„¤ëª…...]
[ì¤‘ë³µëœ ì˜ˆì‹œ...]
`;

// âœ… íš¨ìœ¨ì  (3,000 í† í°)
const prompt = `
[í•µì‹¬ë§Œ ê°„ê²°í•˜ê²Œ]
[ì˜ˆì‹œ ìµœì†Œí™”]
`;
```

**2. RAG ì»¨í…ìŠ¤íŠ¸ ì„ íƒ**
```javascript
// Top-K ì¡°ì ˆ
ragTopK: 5  // 5ê°œ ë¬¸ì„œ (ìµœì )
// Kê°€ í¬ë©´: ë” ë§ì€ ì •ë³´, ë” ë†’ì€ ë¹„ìš©
// Kê°€ ì‘ìœ¼ë©´: ì ì€ ì •ë³´, ë‚®ì€ ë¹„ìš©
```

### 6.4 ì—ëŸ¬ í•¸ë“¤ë§

```javascript
async function callClaudeWithRetry(prompt, maxRetries = 3) {
    for (let i = 0; i < maxRetries; i++) {
        try {
            const response = await anthropic.messages.create({
                model: 'claude-sonnet-4-5-20250929',
                max_tokens: 64000,
                messages: [{ role: 'user', content: prompt }]
            });

            return response;
        } catch (error) {
            if (error.status === 529) {
                // Overloaded â†’ ì¬ì‹œë„
                const delay = Math.pow(2, i) * 1000;  // ì§€ìˆ˜ ë°±ì˜¤í”„
                console.log(`â³ ì¬ì‹œë„ ${i + 1}/${maxRetries} (${delay}ms ëŒ€ê¸°)`);
                await new Promise(resolve => setTimeout(resolve, delay));
            } else if (error.status === 401) {
                // Invalid API key â†’ ì¦‰ì‹œ ì‹¤íŒ¨
                throw new Error('Invalid API key');
            } else {
                throw error;
            }
        }
    }

    throw new Error('ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼');
}
```

---

## 7. í’ˆì§ˆ ë³´ì¦ ì‹œìŠ¤í…œ

### 7.1 GameValidator

```javascript
// server/GameValidator.js (972ì¤„)
class GameValidator {
    async validateGameCode(htmlCode, requirements) {
        const results = {
            score: 0,
            maxScore: 100,
            passed: false,
            errors: [],
            warnings: [],
            details: {}
        };

        // 1. HTML êµ¬ì¡° ê²€ì¦ (20ì )
        results.details.structure = this.validateHTMLStructure(htmlCode);
        results.score += results.details.structure.score;

        // 2. SessionSDK í†µí•© ê²€ì¦ (30ì )
        results.details.sdk = this.validateSessionSDKIntegration(htmlCode);
        results.score += results.details.sdk.score;

        // 3. ì„¼ì„œ ì²˜ë¦¬ ë¡œì§ ê²€ì¦ (20ì )
        results.details.sensor = this.validateSensorProcessing(htmlCode, requirements.gameType);
        results.score += results.details.sensor.score;

        // 4. ê²Œì„ ë¡œì§ ê²€ì¦ (15ì )
        results.details.gameLogic = this.validateGameLogic(htmlCode, requirements.genre);
        results.score += results.details.gameLogic.score;

        // 5. UI/UX ê²€ì¦ (15ì )
        results.details.ui = this.validateUIElements(htmlCode);
        results.score += results.details.ui.score;

        // ì¢…í•© íŒì •
        results.passed = results.score >= 95;

        return results;
    }
}
```

### 7.2 ê²€ì¦ í†µê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          í’ˆì§ˆ ê²€ì¦ í†µê³„ (100íšŒ í…ŒìŠ¤íŠ¸)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í‰ê·  ì ìˆ˜: 97.2ì                                  â”‚
â”‚ â”œâ”€ HTML êµ¬ì¡°: 19.8/20 (99%)                      â”‚
â”‚ â”œâ”€ SessionSDK í†µí•©: 28.5/30 (95%)                â”‚
â”‚ â”œâ”€ ì„¼ì„œ ì²˜ë¦¬: 19.6/20 (98%)                       â”‚
â”‚ â”œâ”€ ê²Œì„ ë¡œì§: 14.3/15 (95%)                       â”‚
â”‚ â””â”€ UI/UX: 14.0/15 (93%)                          â”‚
â”‚                                                  â”‚
â”‚ í†µê³¼ìœ¨: 98% (98/100)                              â”‚
â”‚ ì¬ì‹œë„ í‰ê· : 0.15íšŒ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ë¬¸ì„œ ë**

ë‹¤ìŒ ë¬¸ì„œ: [04_ë°ì´í„°ë² ì´ìŠ¤_êµ¬ì¡°.md](./04_ë°ì´í„°ë² ì´ìŠ¤_êµ¬ì¡°.md)
